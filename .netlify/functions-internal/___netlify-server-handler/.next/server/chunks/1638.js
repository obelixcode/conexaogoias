"use strict";exports.id=1638,exports.ids=[1638],exports.modules={2206:(a,b,c)=>{c.d(b,{O:()=>f});var d=c(21124),e=c(44943);function f({children:a,className:b="",title:c,description:f,footer:g}){return(0,d.jsxs)("div",{className:(0,e.cn)("bg-white border border-gray-200 rounded-lg shadow-sm",b),children:[(c||f)&&(0,d.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[c&&(0,d.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:c}),f&&(0,d.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:f})]}),(0,d.jsx)("div",{className:"px-6 py-4",children:a}),g&&(0,d.jsx)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 rounded-b-lg",children:g})]})}},3200:(a,b,c)=>{c.d(b,{n:()=>f});var d=c(69477),e=c(13737);class f{static async uploadImage(a,b,c,f=3){if(!e.IG)return console.warn("Firebase Storage not available, using fallback URL"),this.getFallbackImageUrl(a);try{if(!(0,d.KR)(e.IG,"test"))throw Error("Storage not properly initialized")}catch(b){return console.warn("Firebase Storage not properly configured, using fallback URL:",b),this.getFallbackImageUrl(a)}let g=null;for(let h=1;h<=f;h++)try{let f=await this.compressImage(a),i=(0,d.KR)(e.IG,b);if(!i)throw Error("Storage reference could not be created");if(c){let a=(0,d.bp)(i,f);return new Promise((b,e)=>{a.on("state_changed",a=>{let b=a.bytesTransferred/a.totalBytes*100;c(b)},a=>{console.error(`Upload attempt ${h} failed:`,a),g=a,e(a)},async()=>{try{let c=await (0,d.qk)(a.snapshot.ref);b(c)}catch(a){console.error(`Get download URL attempt ${h} failed:`,a),g=a,e(a)}})})}{let a=await (0,d.D)(i,f),c=await (0,d.qk)(a.ref);console.log("Upload successful:",{path:b,downloadURL:c});try{let a=await fetch(c,{method:"HEAD"});if(!a.ok)throw console.warn("Uploaded file not accessible:",a.status),Error(`File not accessible: ${a.status}`);console.log("File accessibility test passed")}catch(a){throw console.warn("File accessibility test failed:",a),Error("Uploaded file is not accessible")}return c}}catch(c){if(g=c,console.error(`Upload attempt ${h} failed:`,c),c instanceof Error&&c.message.includes("permission"))return console.warn("Permission denied, using fallback URL"),this.getFallbackImageUrl(a);if(h===f)break;let b=1e3*Math.pow(2,h);await new Promise(a=>setTimeout(a,b))}return console.error("All upload attempts failed, using fallback:",g),this.getFallbackImageUrl(a)}static getFallbackImageUrl(a){return`https://placehold.co/800x400/3B82F6/FFFFFF/png?text=${encodeURIComponent(a.name)}`}static async testStorageConnection(){try{if(!e.IG)return console.error("Firebase Storage not initialized"),!1;if(!(0,d.KR)(e.IG,"test-connection"))return console.error("Could not create storage reference"),!1;return console.log("Firebase Storage connection test successful"),!0}catch(a){return console.error("Firebase Storage connection test failed:",a),!1}}static async uploadCoverImage(a,b,c){let d=Date.now(),e=`cover-${b}-${d}.${a.name.split(".").pop()}`,f=`covers/${e}`;return this.uploadImage(a,f,c)}static async uploadContentImage(a,b){let c=Date.now(),d=`content-${c}.${a.name.split(".").pop()}`,e=`content/${d}`;return this.uploadImage(a,e,b)}static async uploadBannerImage(a,b,c){let d=Date.now(),e=Math.random().toString(36).substring(2,8),f=`banner-temp-${d}-${e}.${a.name.split(".").pop()}`,g=`banners/${f}`;console.log("Uploading banner image:",{fileName:f,path:g});try{let b=await this.uploadImage(a,g,c);return console.log("Banner upload completed:",b),b}catch(b){return console.error("Banner upload failed:",b),this.getFallbackImageUrl(a)}}static async deleteImage(a){try{let b=(0,d.KR)(e.IG,a);await (0,d.XR)(b)}catch(a){console.error("Delete image error:",a)}}static async compressImage(a,b=1920,c=.8){return new Promise(d=>{let e=document.createElement("canvas"),f=e.getContext("2d"),g=new Image;g.onload=()=>{let{width:h,height:i}=g;h>b&&(i=i*b/h,h=b),e.width=h,e.height=i,f?.drawImage(g,0,0,h,i),e.toBlob(b=>{b?d(new File([b],a.name,{type:a.type,lastModified:Date.now()})):d(a)},a.type,c)},g.src=URL.createObjectURL(a)})}static getFileSizeMB(a){return a.size/1048576}static validateImageFile(a){return["image/jpeg","image/jpg","image/png","image/webp"].includes(a.type)?this.getFileSizeMB(a)>5?{isValid:!1,error:`Arquivo muito grande. M\xe1ximo 5MB.`}:{isValid:!0}:{isValid:!1,error:"Tipo de arquivo n\xe3o suportado. Use JPG, PNG ou WebP."}}static generateUniqueFilename(a,b){let c=Date.now(),d=Math.random().toString(36).substring(2,8),e=a.split(".").pop(),f=a.split(".").slice(0,-1).join(".").toLowerCase().replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").trim(),g=b?`${b}-`:"";return`${g}${f}-${c}-${d}.${e}`}static extractPathFromUrl(a){try{let b=new URL(a).pathname.match(/\/o\/(.+)\?/);return b?decodeURIComponent(b[1]):null}catch{return null}}static async cleanupOrphanedImages(a){try{let b=a.map(a=>this.deleteImage(a));await Promise.all(b)}catch(a){throw console.error("Cleanup orphaned images error:",a),Error("Erro ao limpar imagens \xf3rf\xe3s")}}}},43700:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(23339).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},59544:(a,b,c)=>{c.d(b,{a:()=>f});var d=c(21124),e=c(44943);function f({variant:a="primary",size:b="medium",children:c,className:f="",asChild:g=!1,...h}){return(0,d.jsx)("button",{className:(0,e.cn)("inline-flex items-center justify-center font-medium rounded transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",{primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500",tertiary:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",link:"bg-transparent text-blue-600 hover:text-blue-700 hover:underline focus:ring-blue-500"}[a],{small:"px-3 py-1.5 text-sm",medium:"px-4 py-2 text-sm",large:"px-6 py-3 text-base"}[b],f),...h,children:c})}},78231:(a,b,c)=>{c.d(b,{u:()=>h});var d=c(67402),e=c(13737),f=c(3200);let g="media";class h{static async uploadMedia(a,b,c){try{let h,i=f.n.validateImageFile(a);if(!i.isValid)throw Error(i.error);let j=Date.now(),k=`media-${j}-${a.name}`,l=`media/${k}`;try{h=await f.n.uploadImage(a,l)}catch(b){console.warn("Storage upload failed, using fallback:",b),h=`https://via.placeholder.com/800x400/3B82F6/FFFFFF?text=${encodeURIComponent(a.name)}`}return(await (0,d.gS)((0,d.rJ)(e.db,g),{name:b.name||a.name,url:h,type:a.type.startsWith("image/")?"image":a.type.startsWith("video/")?"video":"document",size:a.size,alt:b.alt||"",caption:b.caption||"",uploadedBy:c,isPublic:b.isPublic,uploadedAt:(0,d.O5)(),createdAt:(0,d.O5)(),updatedAt:(0,d.O5)()})).id}catch(a){throw console.error("Upload media error:",a),Error("Erro ao fazer upload do arquivo")}}static async getMediaLibrary(){try{let a=(0,d.P)((0,d.rJ)(e.db,g),(0,d.My)("uploadedAt","desc"));return(await (0,d.GG)(a)).docs.map(a=>{let b=a.data();return{id:a.id,name:b.name||"",url:b.url||"",type:b.type||"image",size:b.size||0,uploadedAt:b.uploadedAt?.toDate()||new Date,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date,alt:b.alt||"",caption:b.caption||"",uploadedBy:b.uploadedBy||"",isPublic:b.isPublic||!1}})}catch(a){throw console.error("Get media library error:",a),Error("Erro ao buscar biblioteca de m\xeddia")}}static async getMediaById(a){try{let b=await (0,d.x7)((0,d.H9)(e.db,g,a));if(!b.exists())return null;let c=b.data();return{id:b.id,...c,uploadedAt:c.uploadedAt?.toDate()||new Date,createdAt:c.createdAt?.toDate()||new Date,updatedAt:c.updatedAt?.toDate()||new Date}}catch(a){throw console.error("Get media by ID error:",a),Error("Erro ao buscar arquivo de m\xeddia")}}static async updateMediaMetadata(a,b){try{await (0,d.mZ)((0,d.H9)(e.db,g,a),{...b,updatedAt:(0,d.O5)()})}catch(a){throw console.error("Update media metadata error:",a),Error("Erro ao atualizar metadados do arquivo")}}static async deleteMedia(a){try{let b=await this.getMediaById(a);if(!b)throw Error("Arquivo n\xe3o encontrado");await f.n.deleteImage(b.url),await (0,d.kd)((0,d.H9)(e.db,g,a))}catch(a){throw console.error("Delete media error:",a),Error("Erro ao excluir arquivo")}}static async searchMedia(a){try{let b=(0,d.P)((0,d.rJ)(e.db,g),(0,d._M)("name",">=",a),(0,d._M)("name","<=",a+"ï£¿"),(0,d.My)("name"));return(await (0,d.GG)(b)).docs.map(a=>{let b=a.data();return{id:a.id,name:b.name||"",url:b.url||"",type:b.type||"image",size:b.size||0,uploadedAt:b.uploadedAt?.toDate()||new Date,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date,alt:b.alt||"",caption:b.caption||"",uploadedBy:b.uploadedBy||"",isPublic:b.isPublic||!1}})}catch(a){throw console.error("Search media error:",a),Error("Erro ao buscar arquivos")}}static async getMediaByType(a){try{let b=(0,d.P)((0,d.rJ)(e.db,g),(0,d._M)("type","==",a),(0,d.My)("uploadedAt","desc"));return(await (0,d.GG)(b)).docs.map(a=>{let b=a.data();return{id:a.id,name:b.name||"",url:b.url||"",type:b.type||"image",size:b.size||0,uploadedAt:b.uploadedAt?.toDate()||new Date,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date,alt:b.alt||"",caption:b.caption||"",uploadedBy:b.uploadedBy||"",isPublic:b.isPublic||!1}})}catch(a){throw console.error("Get media by type error:",a),Error("Erro ao buscar arquivos por tipo")}}static async getPublicMedia(){try{let a=(0,d.P)((0,d.rJ)(e.db,g),(0,d._M)("isPublic","==",!0),(0,d.My)("uploadedAt","desc"));return(await (0,d.GG)(a)).docs.map(a=>{let b=a.data();return{id:a.id,name:b.name||"",url:b.url||"",type:b.type||"image",size:b.size||0,uploadedAt:b.uploadedAt?.toDate()||new Date,createdAt:b.createdAt?.toDate()||new Date,updatedAt:b.updatedAt?.toDate()||new Date,alt:b.alt||"",caption:b.caption||"",uploadedBy:b.uploadedBy||"",isPublic:b.isPublic||!1}})}catch(a){throw console.error("Get public media error:",a),Error("Erro ao buscar arquivos p\xfablicos")}}static async getMediaStats(){try{let a=(await (0,d.GG)((0,d.rJ)(e.db,g))).docs.map(a=>({id:a.id,...a.data()})),b=a.reduce((a,b)=>a+(b.size||0),0),c=a.filter(a=>"image"===a.type).length,f=a.filter(a=>"video"===a.type).length,h=a.filter(a=>"document"===a.type).length;return{totalFiles:a.length,totalSize:b,imagesCount:c,videosCount:f,documentsCount:h}}catch(a){throw console.error("Get media stats error:",a),Error("Erro ao buscar estat\xedsticas de m\xeddia")}}static formatFileSize(a){if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]}static async cleanupOrphanedFiles(){try{console.log("Cleanup orphaned files should be implemented as a Cloud Function")}catch(a){throw console.error("Cleanup orphaned files error:",a),Error("Erro ao limpar arquivos \xf3rf\xe3os")}}}}};