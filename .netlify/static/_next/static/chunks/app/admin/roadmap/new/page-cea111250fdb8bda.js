(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9132],{6917:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>E});var i=s(95155),a=s(12115),t=s(20063),l=s(22544),o=s(66942),c=s(41508),n=s(67909),d=s(35626),u=s(46046),m=s(57828),h=s(3998),x=s(65142),j=s(31120),p=s(86948),v=s(11186),g=s(63554),f=s(23675),y=s(29141),w=s(32549);let N=(0,n.default)(()=>Promise.all([s.e(5004),s.e(277),s.e(912),s.e(9614)]).then(s.bind(s,9614)).then(e=>({default:e.Editor})),{loadableGenerated:{webpack:()=>[9614]},ssr:!1,loading:()=>(0,i.jsx)("div",{className:"border border-gray-300 rounded-lg min-h-[300px] p-4 flex items-center justify-center",children:(0,i.jsx)("div",{className:"text-gray-500 text-sm",children:"Carregando editor..."})})}),b=c.Ikc({title:c.YjP().min(1,"T\xedtulo \xe9 obrigat\xf3rio"),description:c.YjP().optional(),content:c.YjP().min(1,"Conte\xfado \xe9 obrigat\xf3rio"),priority:c.k5n(["high","medium","low"]),coverImage:c.YjP().optional()});function E(){let e=(0,t.useRouter)(),{user:r}=(0,y.J)(),[s,c]=(0,a.useState)(!1),[n,E]=(0,a.useState)(""),[C,S]=(0,a.useState)(""),[A,P]=(0,a.useState)(!1),{register:U,handleSubmit:Z,watch:B,setValue:T,formState:{errors:I,isDirty:k}}=(0,l.mN)({resolver:(0,o.u)(b),defaultValues:{priority:"medium"}}),D=async e=>{if(!r)return void alert("Usu\xe1rio n\xe3o autenticado");c(!0);try{let s={title:e.title,description:e.description,content:e.content,priority:e.priority,coverImage:n};await f.c.createRequest(s,r.uid,r.name||r.email||"Usu\xe1rio"),P(!0)}catch(e){console.error("Error creating roadmap request:",e),alert("Erro ao criar solicita\xe7\xe3o")}finally{c(!1)}};return(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>e.back(),children:[(0,i.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Voltar"]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Nova Solicita\xe7\xe3o"}),(0,i.jsx)("p",{className:"text-gray-600",children:"Crie uma nova solicita\xe7\xe3o de melhoria"})]})]}),(0,i.jsx)("div",{className:"flex items-center space-x-2",children:(0,i.jsxs)(h.$,{onClick:Z(D),disabled:s||!k,children:[(0,i.jsx)(u.A,{className:"h-4 w-4 mr-2"}),s?"Salvando...":"Salvar"]})})]}),(0,i.jsx)("form",{onSubmit:Z(D),className:"space-y-6",children:(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,i.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,i.jsxs)(p.Zp,{children:[(0,i.jsxs)(p.aR,{children:[(0,i.jsx)(p.ZB,{children:"T\xedtulo"}),(0,i.jsx)(p.BT,{children:"T\xedtulo principal da solicita\xe7\xe3o"})]}),(0,i.jsxs)(p.Wu,{children:[(0,i.jsx)(x.p,{...U("title"),placeholder:"Digite o t\xedtulo da solicita\xe7\xe3o",className:I.title?"border-red-500":""}),I.title&&(0,i.jsx)("p",{className:"text-red-500 text-sm mt-1",children:I.title.message})]})]}),(0,i.jsxs)(p.Zp,{children:[(0,i.jsxs)(p.aR,{children:[(0,i.jsx)(p.ZB,{children:"Descri\xe7\xe3o"}),(0,i.jsx)(p.BT,{children:"Descri\xe7\xe3o curta da solicita\xe7\xe3o (opcional)"})]}),(0,i.jsx)(p.Wu,{children:(0,i.jsx)(j.T,{...U("description"),placeholder:"Digite uma descri\xe7\xe3o resumida",rows:3})})]}),(0,i.jsxs)(p.Zp,{children:[(0,i.jsxs)(p.aR,{children:[(0,i.jsx)(p.ZB,{children:"Conte\xfado"}),(0,i.jsx)(p.BT,{children:"Detalhes completos da solicita\xe7\xe3o"})]}),(0,i.jsxs)(p.Wu,{children:[(0,i.jsx)(N,{content:C,onChange:e=>{S(e),T("content",e)},placeholder:"Descreva detalhadamente a melhoria solicitada..."}),I.content&&(0,i.jsx)("p",{className:"text-red-500 text-sm mt-2",children:I.content.message})]})]})]}),(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)(p.Zp,{children:[(0,i.jsxs)(p.aR,{children:[(0,i.jsx)(p.ZB,{children:"Imagem de Capa"}),(0,i.jsx)(p.BT,{children:"Imagem ilustrativa (opcional)"})]}),(0,i.jsx)(p.Wu,{children:(0,i.jsx)(g.G,{onImageUploaded:e=>{E(e)},currentImage:n,aspectRatio:"video"})})]}),(0,i.jsxs)(p.Zp,{children:[(0,i.jsxs)(p.aR,{children:[(0,i.jsx)(p.ZB,{children:"Prioridade"}),(0,i.jsx)(p.BT,{children:"N\xedvel de prioridade da solicita\xe7\xe3o"})]}),(0,i.jsxs)(p.Wu,{children:[(0,i.jsxs)(v.Select,{value:B("priority"),onValueChange:e=>{T("priority",e)},children:[(0,i.jsx)(v.SelectTrigger,{children:(0,i.jsx)(v.SelectValue,{placeholder:"Selecione a prioridade"})}),(0,i.jsxs)(v.SelectContent,{children:[(0,i.jsx)(v.SelectItem,{value:"high",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),"Alta Prioridade"]})}),(0,i.jsx)(v.SelectItem,{value:"medium",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),"M\xe9dia Prioridade"]})}),(0,i.jsx)(v.SelectItem,{value:"low",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Baixa Prioridade"]})})]})]}),I.priority&&(0,i.jsx)("p",{className:"text-red-500 text-sm mt-1",children:I.priority.message})]})]}),k&&(0,i.jsxs)(p.Zp,{children:[(0,i.jsx)(p.aR,{children:(0,i.jsxs)(p.ZB,{className:"flex items-center gap-2",children:[(0,i.jsx)(m.A,{className:"h-4 w-4"}),"Preview"]})}),(0,i.jsx)(p.Wu,{children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("h3",{className:"font-semibold",children:B("title")||"T\xedtulo da solicita\xe7\xe3o"}),B("description")&&(0,i.jsx)("p",{className:"text-sm text-gray-600",children:B("description")}),(0,i.jsxs)("div",{className:"text-xs",children:[(0,i.jsx)("span",{className:"font-medium",children:"Prioridade:"})," ",(0,i.jsxs)("span",{className:"capitalize",children:["high"===B("priority")&&"Alta","medium"===B("priority")&&"M\xe9dia","low"===B("priority")&&"Baixa"]})]})]})})]})]})]})}),(0,i.jsx)(w.D,{isOpen:A,onClose:()=>P(!1),title:"Sucesso!",message:"Sua solicita\xe7\xe3o foi criada com sucesso! Ela j\xe1 est\xe1 dispon\xedvel no roadmap.",redirectTo:"/admin/roadmap"})]})}},29141:(e,r,s)=>{"use strict";s.d(r,{J:()=>c,UserProvider:()=>o});var i=s(95155),a=s(12115),t=s(34426);let l=(0,a.createContext)(void 0);function o(e){let{children:r}=e,[s,o]=(0,a.useState)(null),[c,n]=(0,a.useState)(!0),d=async()=>{try{let e=await t.z.getCurrentUser();o(e)}catch(e){console.error("Error refreshing user:",e),o(null)}};return(0,a.useEffect)(()=>{d().finally(()=>n(!1))},[]),(0,i.jsx)(l.Provider,{value:{user:s,setUser:o,refreshUser:d,isLoading:c},children:r})}function c(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}},34426:(e,r,s)=>{"use strict";s.d(r,{z:()=>o});var i=s(81328),a=s(19708),t=s(14585);let l="users";class o{static async login(e){try{let r=(await (0,i.x9)(t.j2,e.email,e.password)).user,s=await (0,a.x7)((0,a.H9)(t.db,l,r.uid));if(!s.exists())throw Error("Usu\xe1rio n\xe3o encontrado no sistema");let o=s.data();if(!o.isActive)throw Error("Usu\xe1rio desativado");return await (0,a.mZ)((0,a.H9)(t.db,l,r.uid),{lastLoginAt:new Date}),{uid:r.uid,email:r.email,name:o.name,role:o.role,isActive:o.isActive,avatar:o.avatar}}catch(e){throw console.error("Login error:",e),Error("Erro ao fazer login. Verifique suas credenciais.")}}static async logout(){try{await (0,i.CI)(t.j2)}catch(e){throw console.error("Logout error:",e),Error("Erro ao fazer logout")}}static async getCurrentUser(){return new Promise(e=>{let r=(0,i.hg)(t.j2,async s=>{if(r(),!s)return void e(null);try{let r=await (0,a.x7)((0,a.H9)(t.db,l,s.uid));if(!r.exists())return void e(null);let i=r.data();if(!i.isActive)return void e(null);e({uid:s.uid,email:s.email,name:i.name,role:i.role,isActive:i.isActive,avatar:i.avatar})}catch(r){console.error("Get current user error:",r),e(null)}})})}static async createAdminUser(e){try{throw Error("Cria\xe7\xe3o de usu\xe1rios deve ser feita via Firebase Console ou server-side function")}catch(e){throw console.error("Create admin user error:",e),Error("Erro ao criar usu\xe1rio administrador")}}static async updateAdminUser(e,r){try{await (0,a.mZ)((0,a.H9)(t.db,l,e),{...r,updatedAt:new Date})}catch(e){throw console.error("Update admin user error:",e),Error("Erro ao atualizar usu\xe1rio")}}static async getAdminUser(e){try{let r=await (0,a.x7)((0,a.H9)(t.db,l,e));if(!r.exists())return null;return r.data()}catch(e){throw console.error("Get admin user error:",e),Error("Erro ao buscar usu\xe1rio")}}static hasPermission(e,r){let s={editor:1,admin:2,super_admin:3};return s[e]>=s[r]}static onAuthStateChange(e){return(0,i.hg)(t.j2,async r=>{if(!r)return void e(null);try{let s=await (0,a.x7)((0,a.H9)(t.db,l,r.uid));if(!s.exists())return void e(null);let i=s.data();if(!i.isActive)return void e(null);e({uid:r.uid,email:r.email,name:i.name,role:i.role,isActive:i.isActive,avatar:i.avatar})}catch(r){console.error("Auth state change error:",r),e(null)}})}}},98724:(e,r,s)=>{Promise.resolve().then(s.bind(s,6917))}},e=>{e.O(0,[9135,7210,9779,3643,5239,3148,4127,3446,477,4337,2211,3554,5142,8441,1255,7358],()=>e(e.s=98724)),_N_E=e.O()}]);